# update [![NPM version](https://badge.fury.io/js/update.svg)](http://badge.fury.io/js/update)  [![Build Status](https://travis-ci.org/jonschlinkert/update.svg)](https://travis-ci.org/jonschlinkert/update)

> Lint and update your project to meet your standards.

<!-- toc -->

* [Usage](#usage)
  - [What's this about?](#what-s-this-about-)
  - [The goal](#the-goal)
  - [Next](#next)

* [CLI](#cli)
* [API](#api)
* [Related projects](#related-projects)
* [Running tests](#running-tests)
* [Contributing](#contributing)
* [Author](#author)
* [License](#license)

_(Table of contents generated by [verb])_

<!-- tocstop -->

## Install with [npm](npmjs.org)

```bash
npm i update --save
```

## Usage

```js
var update = require('update');
```

This is an experimental library that is build 100% on top of [verb], but it's not quite ready to use on your projects.

### What's this about?

Update is a CLI tool that loads personal defaults/preferences, then runs a series of [verb](https://github.com/assemble/verb) plugins, transforms and "normalizers" on targeted files in the current project.

**For example:**

* it updates the copyright dates in banners, the README and LICENSE files
* it renames files to be the way I like them (like `LICENSE-MIT` => `LICENSE`)
* it updates banners to ensure they have the correct project URL and license information
* it updates `.jshintrc` with my lastest preferences
* it updates `.editorconfig` with my latest preferences
* it updates `package.json` properties with my latest preferences

etc... this is maybe 20% of what it does currently. There are some bugs to work out, but I can tell this project is going to be worth spending time on. It's already paying off.

### The goal

The goal is to be able to easily update and normalize existing projects from the command line using a compbination of:

* **global defaults** for project metadata, like your github username, license preference, and other properties that change very little if at all from project-to-project.
* **normalizers** that will normalize and update virtually anything in the project to:
  - use your (latest) preference
  - meet the (latest) standards for whatever piece of metadata is being updated. For example, it would lint your `.travis.md` files to ensure that `iojs` has been added to the `node_js` versions.

### Next

After I completely understand how this should work, I'll:

1. remove all logic and preferences that are specific to my own projects.
2. Split everything out into plugins, helpers, utils etc.
3. Try to make everything compatible with gulp plugins, so we don't need to think about another format.

For now, however, this project is not at all idiomatic. A lot of the logic is pretty opinionated, there is a lot of duplication, and some of the plugins are just sloppy. As a rule-of-thumb I like to get things working as a POC before I spend time cleaning up code.

## Install globally with [npm](npmjs.org):

```bash
npm i -g update
```

## CLI

From the command line, run:

```bash
update
```

## API

### [Update](index.js#L36)

Initialize `Update`.

**Example**

```js
var app = new Update();
```

### [.src](index.js#L67)

Glob patterns or filepaths to source files.

**Example usage**

**Params**

* `glob` **{String|Array}**: Glob patterns or file paths to source files.
* `options` **{Object}**: Options or locals to merge into the context and/or pass to `src` plugins

**Examples**

```js
app.src('*.js')
```

```js
app.task('web-app', function() {
  app.src('templates/*')
    app.dest(process.cwd())
});
```

### [.templates](index.js#L93)

Glob patterns or filepaths to templates stored in the `./templates` directory of an updater.

**Example usage**

**Params**

* `glob` **{String|Array}**: Glob patterns or file paths to source files.
* `options` **{Object}**: Options or locals to merge into the context and/or pass to `src` plugins

**Examples**

```js
app.templates('*.js')
```

```js
app.task('licenses', function() {
  app.templates('templates/licenses/*')
    app.dest(process.cwd())
});
```

### [.dest](index.js#L118)

Specify a destination for processed files.

**Example usage**

**Params**

* `dest` **{String|Function}**: File path or rename function.
* `options` **{Object}**: Options or locals to merge into the context and/or pass to `dest` plugins

**Examples**

```js
app.dest('dist', {ext: '.xml'})
```

```js
app.task('foo', function() {
  app.src('templates/*')
    app.dest('dist', {ext: '.xml'})
});
```

### [.task](index.js#L175)

Define a task.

**Params**

* `name` **{String}**
* `fn` **{Function}**

**Example**

```js
app.task('docs', function() {
  app.src('*.js').pipe(app.dest('.'));
});
```

### [.getTask](index.js#L190)

Get the id from the current task. Used in plugins to get the current session.

* `returns` **{String}** `task`: The currently running task.

**Example**

```js
var id = verb.getTask();
verb.views[id];
```

### [.getCollection](index.js#L211)

Get the collection name (inflection) of the given template type.

* `returns` **{String}** `name`: Singular name of the collection to get

**Example**

```js
var collection = verb.getCollection('page');
// gets the `pages` collection
//=> {a: {}, b: {}, ...}
```

### [.getViews](index.js#L228)

Used in plugins to get a template from the current session.

* `returns` **{String}** `id`: Pass the task-id from the current session.
* `returns` **{Object}** `file`: Vinyl file object. Must have an `id` property that matches the `id` of the session.

**Example**

```js
var views = app.getViews();
```

### [.getFile](index.js#L244)

Get a template (file) from the current session in a stream.

* `returns` **{Object}** `file`: Vinyl file object. Must have an `id` property that matches the `id` of the session.

**Example**

```js
var file = app.getFile(file);
```

### [.pushToStream](index.js#L261)

Get a template from the current session, convert it to a vinyl file, and push it into the stream.

**Params**

* `stream` **{Stream}**: Vinyl stream
* `id` **{String}**: Get the session `id` using `app.getTask()`

**Example**

```js
app.pushToStream(file);
```

### [.taskFiles](index.js#L278)

`taskFiles` is a session-context-specific getter that returns the collection of files from the current `task`.

* `returns` **{Object}**: Get the files from the current task.

**Example**

```js
var files = verb.taskFiles;
```

### [.updater](index.js#L301)

Set or get a generator function by `name`.

**Params**

* `name` **{String}**
* `fn` **{Function}**: The updater plugin function

**Example**

```js
// set an updater
app.updater('foo', require('updater-foo'));

// get an updater
var foo = app.updater('foo');
```

### [.watch](index.js#L342)

Re-run the specified task(s) when a file changes.

**Params**

* `glob` **{String|Array}**: Filepaths or glob patterns.
* `fn` **{Function}**: Task(s) to watch.

**Example**

```js
app.task('watch', function() {
  app.watch('docs/*.md', ['docs']);
});
```

## Related projects

{%= related([]) %}

## Running tests

Install dev dependencies:

```bash
npm i -d && npm test
```

## Contributing

Pull requests and stars are always welcome. For bugs and feature requests, [please create an issue](https://github.com/jonschlinkert/update/issues)

## Author

**Jon Schlinkert**

+ [github/jonschlinkert](https://github.com/jonschlinkert)
+ [twitter/jonschlinkert](http://twitter.com/jonschlinkert)

## License

Copyright (c) 2015 Jon Schlinkert
Released under the MIT license.

***

_This file was generated by [verb-cli](https://github.com/assemble/verb-cli) on April 27, 2015._

<!-- reflinks generated by verb-reflinks plugin -->

[assemble]: http://assemble.io
[template]: https://github.com/jonschlinkert/template
[verb]: https://github.com/assemble/verb